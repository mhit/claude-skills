# 四柱推命 標準レポート構造

## 概要

このドキュメントは、Word文書で四柱推命レポートを作成する際の**必須項目**と**推奨順序**を定義します。
項目がばらけないよう、この構造に従ってください。

## 必須: docxスキルの使用

**重要**: Word文書作成時は、必ず `/mnt/skills/public/docx/SKILL.md` のdocxスキルを使用してください。

### 手順

1. **スキルファイルを読む**
   ```bash
   cat /mnt/skills/public/docx/SKILL.md
   ```

2. **docx-js.mdを完全に読む**（範囲指定なし）
   ```bash
   cat /mnt/skills/public/docx/docx-js.md
   ```

3. **JavaScriptでWord文書を作成**
   - Document, Paragraph, TextRun コンポーネントを使用
   - Packer.toBuffer() で .docx にエクスポート

4. **Pythonのpython-docxライブラリは使わない**
   - 表現や段落がおかしくなることがある
   - docxスキルの方が品質が高い

---

## 標準レポート構造

### 1. 表紙（必須）

```
タイトル: 四柱推命・姓名判断 鑑定書
        または
        〇〇様 命式鑑定書

生年月日: YYYY年MM月DD日
生まれた時刻: HH:MM
性別: 男性/女性
作成日: YYYY年MM月DD日
```

**スタイル**:
- タイトル: 24pt, 太字, 中央揃え
- 本文: 12pt, 左揃え

---

### 2. 命式表（必須）

```
【四柱八字】

     時柱    日柱    月柱    年柱
天干  ○      ○      ○      ○
地支  ○      ○      ○      ○

通変星 ○      ○      ○      ○
十二運 ○      ○      ○      ○
```

**表形式で表示**:
- 4列×4行のテーブル
- ヘッダーは太字
- 枠線あり

**追加情報**:
- 日干: ○（○行）
- 身強・身弱: ○
- 五行バランス: 木○ 火○ 土○ 金○ 水○

---

### 3. 基本性格（必須）

**【日干の特性】**
- 日干「○」の基本的な性質
- ○行の特徴
- エネルギーの方向性

**【通変星からの分析】**
- 月柱の通変星（社会性・仕事運）
- 日柱の通変星（本質・配偶者運）
- 時柱の通変星（晩年・子供運）

**【多面的な性格】**
- 表の顔と裏の顔
- 矛盾する特性（3箇所以上）
- 条件による違い

**重要**: 一般論ではなく、**この人の命式に固有の分析**を書く。

---

### 4. 人生のハイライト期間（必須）

**【ハイライト期間】**
- 期間: ○歳〜○歳
- ピーク年齢: ○歳
- 理論的根拠
  - 日柱の年齢域との関係
  - 大運の影響
  - 身強身弱との関係

**【この期間の特徴】**
- 社会的な活躍
- キャリアのピーク
- 家庭・人間関係の充実

**【準備期間（ハイライト前）】**
- ○歳〜○歳
- やるべきこと

**【安定期（ハイライト後）】**
- ○歳以降
- 基盤の活用

**注意**: 34-55歳に固定せず、個人の命式に基づいて計算した期間を使用。

---

### 5. 年代別運勢（必須）

各大運期について、以下を記載：

**【第1大運: ○歳〜○歳（○○）】**
- 通変星: ○
- 十二運: ○
- 五行: ○
- 総合評価: ★★★☆☆
- 特徴:
  - 主なテーマ
  - チャンスとリスク
  - 注意点
- 具体的アドバイス

**（第2大運以降も同様）**

最低でも第5大運（50歳前後）までは詳細に記載。

---

### 6. アンダーテンション期間（必須）

**【エネルギー低下期】**
- 強アンダー月: ○月、○月、○月
- 弱アンダー月: ○月、○月
- 強アンダー時間帯: ○時〜○時

**【理論的根拠】**
- 日干「○」の十二長生
- 五行の相生相剋

**【この期間の過ごし方】**
1. 重要な決断を避ける
2. 充電・点検に集中
3. 勘違い・誤解に注意
4. 悪い癖が出やすい

**【ポジティブな活用法】**
- 深い思索
- 内面の成長
- 次の活動期への準備

---

### 7. 神殺（重要な星のみ）

**【吉神】**
- ○○（柱）: 意味と影響
- ○○（柱）: 意味と影響

**【凶神】**
- ○○（柱）: 意味と影響
- ○○（柱）: 意味と影響

**【吉凶の相互作用】**
- 天乙貴人による凶神の軽減
- 特殊な組み合わせの効果

**【活用法・対策】**
- 吉神の活かし方
- 凶神の吉転方法（活人業など）

**注意**: 全ての神殺を列挙するのではなく、**特に影響が大きいもの**に絞る。

---

### 8. 開運アドバイス（必須）

**【適職】**
- 日干と通変星から導かれる適性
- 具体的な職業例
- 向いていない仕事

**【恋愛・結婚運】**
- パートナーとの相性
- 結婚に適した時期
- 注意点

**【健康運】**
- 弱い部位
- 注意すべき時期
- 予防法

**【財運】**
- 金銭感覚
- 蓄財能力
- 財運が高まる時期

**【開運方法】**
- 吉方位
- ラッキーカラー
- 開運行動

---

### 9. 特別な組み合わせ（該当する場合のみ）

以下のような特殊なケースがある場合のみ記載：

- 従格・化格・専旺格
- 特殊な通変星の組み合わせ
  - 印綬+帝旺（芸術家適性）
  - 傷官+正財（技術で財を成す）
  - 羊刃+偏官（英雄・豪傑）
- 複数の吉神・凶神の重複

---

### 10. 相性判定（2人の場合のみ）

**【総合相性】**
- スコア: ○/10
- タイプ: 非常に良好/良好/普通/やや難/困難

**【詳細分析】**
- 三合・六合などの吉の組み合わせ
- 相冲・相刑などの凶の組み合わせ
- 年支の相性（最重要）
- 日支の相性（日常生活）

**【アドバイス】**
- 良い点を活かす方法
- 課題への対処法
- 相互理解のポイント

---

### 11. 100年運勢表（オプション、別ページ推奨）

年齢ごとの運勢を表形式で:

| 年齢 | 西暦 | 干支 | 大運 | 年運 | 総合 | 主な出来事 |
|------|------|------|------|------|------|-----------|
| 1    | ...  | ...  | ...  | ...  | ★★★ | ...      |

**注意**: 100年分は非常に長いので、別ページまたは別ファイルにする。

---

### 12. 総合評価（必須）

**【命式の総合的な解釈】**
- この命式の最大の強み
- 最大の課題
- 人生のテーマ

**【人生の課題と成長の方向性】**
- 若年期の課題
- 中年期の課題
- 晩年期の課題
- 一生涯のテーマ

**【最後に】**
- 占いは「傾向」であり「運命」ではない
- 主体的に人生を切り開くことの重要性
- ポジティブな締めくくり

---

## 品質チェックリスト

レポート作成後、以下を確認：

### 内容の品質
- [ ] 参考資料からのコピペがない（完全にオリジナル）
- [ ] この人固有の命式に基づいた分析である
- [ ] 一般論になっていない（「〇〇を持つ人は」ではない）
- [ ] 矛盾する特性を3箇所以上含む（条件付きで説明）
- [ ] 具体的な年齢・時期を明示している
- [ ] 五行のバランスから論理的に導いている

### 構造の品質
- [ ] 必須項目が全て含まれている
- [ ] 推奨順序に従っている
- [ ] 見出しが統一されている
- [ ] 表が適切に使用されている
- [ ] ページ数が適切（20〜40ページ程度）

### 表現の品質
- [ ] 過度に不安を煽っていない
- [ ] 凶神にもポジティブな活用法を含めている
- [ ] 「傾向がある」という表現で断定を避けている
- [ ] 専門用語に説明を付けている
- [ ] 読みやすい文章になっている

---

## 実装例（JavaScript with docx-js）

```javascript
import { Document, Paragraph, TextRun, Table, TableCell, TableRow, AlignmentType } from 'docx';
import { Packer } from 'docx';
import * as fs from 'fs';

// 計算結果を読み込み
const results = JSON.parse(fs.readFileSync('results.json', 'utf8'));

// 文書を作成
const doc = new Document({
  sections: [{
    properties: {},
    children: [
      // 1. 表紙
      new Paragraph({
        text: "四柱推命・姓名判断 鑑定書",
        heading: "Title",
        alignment: AlignmentType.CENTER,
        spacing: { after: 400 }
      }),
      
      new Paragraph({
        children: [
          new TextRun(`生年月日: ${results.input.birth_date}`),
        ],
        alignment: AlignmentType.CENTER
      }),
      
      // ... 続く
      
      // 2. 命式表
      new Paragraph({
        text: "【四柱八字】",
        heading: "Heading1",
        spacing: { before: 400, after: 200 }
      }),
      
      new Table({
        rows: [
          new TableRow({
            children: [
              new TableCell({ children: [new Paragraph("時柱")] }),
              new TableCell({ children: [new Paragraph("日柱")] }),
              new TableCell({ children: [new Paragraph("月柱")] }),
              new TableCell({ children: [new Paragraph("年柱")] }),
            ]
          }),
          // ... 続く
        ]
      }),
      
      // 以降の章も同様に作成
    ]
  }]
});

// .docxファイルとして保存
Packer.toBuffer(doc).then(buffer => {
  fs.writeFileSync('鑑定書.docx', buffer);
  console.log('Document created successfully!');
});
```

---

## まとめ

1. **docxスキルを必ず使う**（Pythonライブラリは使わない）
2. **標準構造に従う**（項目がばらけない）
3. **品質チェックリストで確認**
4. **この人固有の分析を書く**（一般論禁止）

この構造に従えば、一貫性のある高品質なレポートが作成できます。
