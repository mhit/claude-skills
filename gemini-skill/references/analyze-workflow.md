# Analyze Workflow - 大規模分析

Geminiの巨大コンテキストを活用して、大量のファイルやログを一括分析する。

## 推奨モデル

**`gemini-2.5-flash`** - コスパ最高、1Mトークンコンテキスト

## いつ使うか

- 大量のログファイルを分析したい（Claudeのコンテキストに収まらない）
- 複数の大きなファイルを同時に比較したい
- コードベース全体のパターンを分析したい
- 長大なドキュメントを要約したい

## コンテキストサイズ目安

| モデル | コンテキスト | コスト | 適した用途 |
|--------|-------------|--------|-----------|
| Claude | ~200K tokens | - | 通常のタスク |
| Gemini 2.5 Flash | 1M tokens | 低 | 大規模分析（推奨） |
| Gemini 2.5 Pro | 1M tokens | 中 | 複雑な分析 |
| Gemini 3 Pro | 1M tokens | 高 | 最高品質 |

**判断基準**: ファイル合計が100KB以上、または10ファイル以上 → Gemini推奨

## 実行手順

### 1. 対象ファイル収集

```bash
# ログファイル収集
find /var/log -name "*.log" -mtime -1 -exec cat {} \; > /tmp/logs_combined.txt

# コードベース収集（特定パターン）
find src -name "*.ts" -exec cat {} \; > /tmp/codebase.txt

# サイズ確認
wc -c /tmp/logs_combined.txt
```

### 2. Gemini呼び出し

```bash
# ログ分析（Gemini 2.5 Flash推奨 - コスパ最高）
gemini -m gemini-2.5-flash "以下のログを分析し、エラーパターン、異常、改善点を特定してください" < /tmp/logs_combined.txt

# コード分析
gemini -m gemini-2.5-flash "以下のコードベースを分析し、アーキテクチャパターン、改善点、潜在的な問題を特定してください" < /tmp/codebase.txt

# gemini-call.shを使う場合
gemini-call.sh --task analyze "エラーパターンを特定して" < /tmp/logs_combined.txt
```

### 3. プロンプト例

**ログ分析**:
```
以下のログを分析してください:
1. エラーや警告のパターンを特定
2. 時系列での異常を検出
3. 根本原因の推定
4. 改善提案
```

**コードベース分析**:
```
以下のコードベースを分析してください:
1. アーキテクチャパターンの特定
2. コードの重複や改善点
3. 潜在的なバグやセキュリティ問題
4. リファクタリング提案
```

**ドキュメント要約**:
```
以下の長いドキュメントを要約してください:
1. 主要なポイント（5-10項目）
2. 重要な決定事項
3. アクションアイテム
```

## 結果の活用

Geminiの分析結果をClaudeに渡して:

1. 具体的な修正コードの生成
2. 詳細な実装計画の作成
3. 特定の問題への深掘り
